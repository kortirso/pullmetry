<% if @insightable.is_a?(Repository) && repository_insights.any? %>
  <h2>Repository insights</h2>
  <div id="repository-insights" class="flex flex-row">
    <div class="flex-1 p-4">
      <p>Open pull requests - <%= render_repository_insight(:open_pull_requests_count) %></p>
      <p>Commented pull requests - <%= render_repository_insight(:commented_pull_requests_count) %></p>
      <p>Reviewed pull requests - <%= render_repository_insight(:reviewed_pull_requests_count) %></p>
      <p>Merged pull requests - <%= render_repository_insight(:merged_pull_requests_count) %></p>
    </div>
    <div class="flex-1 p-4">
      <p>Avg comment time - <%= render_repository_insight(:average_comment_time) %></p>
      <p>Avg review time - <%= render_repository_insight(:average_review_time) %></p>
      <p>Avg merge time - <%= render_repository_insight(:average_merge_time) %></p>
    </div>
    <div class="flex-1 p-4">
      <p>Comments - <%= render_repository_insight(:comments_count) %></p>
      <p>Avg comments - <%= render_repository_insight(:average_comments_count) %></p>
      <p>Changed LOC - <%= render_repository_insight(:changed_loc) %></p>
      <p>Avg changed LOC - <%= render_repository_insight(:average_changed_loc) %></p>
    </div>
  </div>
<% end %>
<h2>Developer insights</h2>
<% if actual_insights.size.positive? %>
  <table class="table" cellSpacing="0">
    <thead>
      <tr>
        <th></th>
        <th>Developer</th>
        <% insight_fields.each do |insight_field| %>
          <th><%= Insight::SHORT_ATTRIBUTE_NAMES[insight_field.to_sym] %></th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% actual_insights.each do |insight| %>
        <tr>
          <%= render Views::Shared::InsightsEntityComponent.new(entity_id: insight.entity_id) %>
          <% insight_fields.each do |insight_field| %>
            <td>
              <%= render_insight_field(insight, insight_field) %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <% if @access_token %>
    <p>There are no insights yet.</p>
  <% elsif @insightable.is_a?(Company) && @insightable.repositories_count.to_i.zero? %>
    <p>You need to create repository first at <%= link_to t('components.page_wrappers.page_component.repositories'), repositories_path %>.</p>
  <% else %>
    <p>You need to add access token first.</p>
  <% end %>
<% end %>
