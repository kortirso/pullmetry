<%= render PageWrappers::UserComponent.new do %>
  <div class="flex justify-between items-center mb-8">
    <h1 class="m-0">Companies</h1>
    <%= link_to 'Create company', new_company_path, class: 'btn-primary' %>
  </div>
  <section>
    <% @companies.each do |company| %>
      <%=
        react_component 'Company',
          uuid: company.uuid,
          title: company.title,
          repositories_count: company.repositories.size,
          repositories_url: company_repositories_path(company_id: company.uuid),
          unaccessable: company.access_token && !company.accessable,
          edit_links: allowed_to?(:update?, company) ? {
            access_token: link_to((company.access_token ? 'Refresh access token' : 'Add access token'), new_company_access_token_path(company.uuid), class: 'button small'),
            configuration: link_to('Edit configuration', edit_company_configuration_path(company.uuid), class: 'button small'),
            destroy: button_to('Destroy company', company_path(company.uuid), class: 'button danger small', method: :delete, onclick: "return confirm('Are you sure you wish to delete company?')")
          } : nil
      %>
    <% end %>
    <%== pagy_nav(@pagy) if @pagy.pages > 1 %>
  </section>
<% end %>
